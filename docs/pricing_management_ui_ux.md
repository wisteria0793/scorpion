# 施設価格設定管理 UI/UX 設計書

## 概要
Beds24 APIを利用して、管理ページ上で各施設の価格設定、基本人数、追加料金などを確認・編集できる機能の設計

---

## 1. 必要な情報の確認

### 1.1 Beds24 APIで取得可能な情報
- **基本情報**
  - Property ID（beds24_property_key）
  - 施設名
  - 基本宿泊可能人数（最大収容人数）

- **価格設定関連**
  - 基本料金（基本人数での1泊の価格）
  - 基本人数（デフォルト宿泊人数）
  - 追加大人料金（基本人数を超える大人1人あたりの追加料金）
  - 追加子供料金（基本人数を超える子供1人あたりの追加料金）
  - 最小宿泊日数
  - チェックイン・チェックアウト時刻

- **キャレンダー・在庫管理**
  - 日別の価格設定
  - ブラックアウト（予約不可日）
  - 最小宿泊日数（日別設定）

---

## 2. UI/UXデザイン案の比較

### **案1: Beds24風カレンダービュー（推奨）**

#### メリット
✅ ユーザーが既に慣れている UI（Beds24利用者）
✅ 日別の価格・ブラックアウト設定が一目瞭然
✅ 複数月の並行表示で傾向把握が容易
✅ ドラッグ&ドロップで複数日の一括設定が可能

#### デメリット
❌ 開発コストが高い
❌ レスポンシブ対応が複雑
❌ 実装に専門ライブラリが必要（React Big Calendar など）

#### 実装パターン
```
┌─────────────────────────────────────────────────┐
│ 施設価格設定 - 「〇〇〇ハウス」                   │
└─────────────────────────────────────────────────┘

┌─ フィルター ──────────────────────┐
│ 日付範囲:  2026/3/1 ～ 2026/5/31   │
│ 表示単位: [月表示] [週表示] [日表示] │
└────────────────────────────────────┘

┌─ 2026年3月 ──────────────────────────────────┐
│ 日 月 火 水 木 金 土                            │
│        1  2  3  4  5  6                      │
│ ¥10K ¥10K ¥12K ¥12K ¥15K ¥15K ¥15K          │
│ 7  8  9  10 11 12 13                        │
│ ¥10K ¥10K ¥10K 🚫  🚫  ¥10K ¥15K            │
│                                             │
│ 凡例: 🚫 = ブラックアウト                      │
└────────────────────────────────────┘

◆ クリック/ドラッグで編集
  - 単日クリック：詳細編集ダイアログを開く
  - 複数日ドラッグ：一括設定
```

---

### **案2: テーブルビュー + エクスパンド（バランス型）**

#### メリット
✅ 実装コストが中程度
✅ 全体像がコンパクト
✅ モバイルでも対応しやすい
✅ 基本設定と日別設定を階層的に管理

#### デメリット
❌ 日別の価格差が視覚的に分かりにくい
❌ スクロールが多くなる
❌ 一度に見える情報量が制限される

#### 実装パターン
```
┌─────────────────────────────────────────────────┐
│ 施設価格設定 - 「〇〇〇ハウス」                   │
└─────────────────────────────────────────────────┘

📋 基本設定
┌─────────────────────────────────────────────────┐
│ 基本料金: ¥10,000 / 泊    [編集]                 │
│ 基本人数: 4名             [編集]                 │
│ 追加大人料金: ¥3,000 / 名  [編集]                │
│ 追加子供料金: ¥1,500 / 名  [編集]                │
│ 最小宿泊日数: 2 泊        [編集]                 │
└─────────────────────────────────────────────────┘

📅 日別設定
┌─────────────────────────────────────────────────┐
│ 日付範囲: [2026/3/1] ～ [2026/5/31]  [適用]     │
│                                                │
│ 2026年3月                                        │
│ ┌─────────────────────────────────────────────┐ │
│ │ 日付      │ 価格    │ 状態      │ 操作         │ │
│ ├─────────────────────────────────────────────┤ │
│ │ 3/1(日)  │ ¥10,000 │ 販売中    │ [編集]       │ │
│ │ 3/2(月)  │ ¥10,000 │ 販売中    │ [編集]       │ │
│ │ 3/3(火)  │ ¥12,000 │ 販売中    │ [編集] [削除]│ │
│ │ 3/4(水)  │ ¥10,000 │ ブラック │ [削除]       │ │
│ │ ...      │ ...    │ ...     │ ...        │ │
│ └─────────────────────────────────────────────┘ │
│ [◀ 前月] [次月 ▶]                                │
└─────────────────────────────────────────────────┘

[一括設定] [インポート]
```

---

### **案3: ハイブリッド型（推奨+実装容易）**

#### メリット
✅ 基本情報はフォーム、日別設定はカレンダー
✅ 最も直感的で使いやすい
✅ 実装難易度が程よい
✅ Beds24との統合が自然

#### デメリット
❌ 2つの UI パターンを覚える必要がある

#### 実装パターン
```
┌──────────────────────────────────────────────────────┐
│ 施設価格設定 - 「〇〇〇ハウス」                        │
└──────────────────────────────────────────────────────┘

┌─ 基本設定パネル ─────────────────────────────────────┐
│ [基本料金]     ¥10,000 [編集]                        │
│ [基本人数]     4 名 [編集]                            │
│ [追加大人料金] ¥3,000/名 [編集]                      │
│ [追加子供料金] ¥1,500/名 [編集]                      │
└──────────────────────────────────────────────────────┘

┌─ 日別価格設定 (カレンダー)────────────────────────────┐
│                                                        │
│  2026年3月          [◀][▶]    [週表示] [月表示]      │
│                                                        │
│ 日  月  火  水  木  金  土                              │
│      1   2   3   4   5   6                           │
│ ¥10K ¥10K ¥12K ¥12K ¥15K ¥15K ¥15K                  │
│  7   8   9  10  11  12  13                          │
│ ¥10K ¥10K ¥10K  🚫  🚫 ¥10K ¥15K                    │
│                                                        │
│ 💡 クリック/ドラッグで編集 | [一括設定] [CSVインポート] │
└──────────────────────────────────────────────────────┘
```

---

## 3. 推奨デザイン案の詳細仕様

### **方針: ハイブリッド型 + シンプルなカレンダー**

---

### 3.1 基本情報セクション（編集モーダル）

```jsx
// 編集ダイアログ
<Dialog title="基本設定を編集">
  <TextField label="基本料金 (¥/泊)" value={basPrice} />
  <TextField label="基本人数" type="number" value={baseGuests} />
  <TextField label="追加大人料金 (¥/名)" value={adultExtra} />
  <TextField label="追加子供料金 (¥/名)" value={childExtra} />
  <Select label="最小宿泊日数">
    <option>1 泊</option>
    <option>2 泊</option>
    <option>3 泊以上</option>
  </Select>
  <Checkbox label="Beds24と同期" />
  [保存] [キャンセル]
</Dialog>
```

---

### 3.2 日別設定カレンダー

#### 単日編集（モーダル）
```
┌───────────────────────────────────┐
│ 2026年3月3日（火）の価格設定      │
├───────────────────────────────────┤
│ 通常価格: ¥10,000 / 泊           │
│ 本日の価格:                       │
│   [¥10,000]  [¥12,000] [¥15,000] │ ← クイック設定
│   または、カスタム: [¥      ]     │
│                                   │
│ □ この日を予約不可（ブラックアウト）│
│ □ 最小宿泊日数を変更              │
│   [1] [2] [3] [4] [5]           │
│                                   │
│ [Beds24と同期] [保存] [キャンセル]│
└───────────────────────────────────┘
```

#### 複数日一括設定
```
ドラッグ＆ドロップで複数日を選択
↓
┌───────────────────────────────────┐
│ 3月3日～3月10日（複数日）の設定   │
├───────────────────────────────────┤
│ 実施日数: 8 日間                  │
│                                   │
│ ◆ 価格設定:                       │
│   (●) 基本料金 ¥10,000            │
│   ( ) カスタム: ¥[         ]     │
│   ( ) 季節料金:                   │
│         - 最大 ¥[      ]          │
│         - 最小 ¥[      ]          │
│                                   │
│ ◆ 在庫状態:                       │
│   ( ) 販売中                      │
│   (●) ブラックアウト              │
│                                   │
│ [プレビュー] [適用] [キャンセル]  │
└───────────────────────────────────┘
```

---

### 3.3 データインポート機能

```
┌──────────────────────────────────────┐
│ CSVインポート                         │
├──────────────────────────────────────┤
│ [ファイルを選択]  sample.csv          │
│                                      │
│ 期待される形式:                      │
│ 日付,価格,ブラックアウト             │
│ 2026-03-01,10000,0                  │
│ 2026-03-02,12000,0                  │
│ 2026-03-03,0,1                      │
│                                      │
│ □ 既存データを置き換える             │
│ ☑ 既存データにマージ                 │
│                                      │
│ [プレビュー] [インポート] [キャンセル]│
└──────────────────────────────────────┘
```

---

### 3.4 Beds24同期機能

```
┌──────────────────────────────────────┐
│ Beds24と同期                         │
├──────────────────────────────────────┤
│ ◆ 同期範囲:                          │
│   (●) 基本設定のみ                  │
│   ( ) 基本設定 + 日別価格            │
│   ( ) 全て同期（上書き注意）        │
│                                      │
│ ◆ 最後の同期: 2026-03-08 14:30     │
│                                      │
│ 💡 ヒント:                           │
│   - 基本設定: 施設の基本料金や人数   │
│   - 日別価格: Beds24設定の価格を    │
│     このシステムに反映               │
│                                      │
│ [同期開始] [履歴] [キャンセル]       │
└──────────────────────────────────────┘
```

---

## 4. ナビゲーション構成

### 4.1 既存の施設管理ページからのナビゲーション

```
施設管理
├── 施設一覧
│   └── [各施設] → 詳細ページ
│       ├── [基本情報] (名前、住所等)
│       ├── [画像管理]
│       ├── [料金・在庫設定] ← 新規追加
│       │   ├── 基本設定タブ
│       │   ├── カレンダータブ
│       │   └── CSV/同期タブ
│       └── [削除]
```

### 4.2 新規ページ構成

```
/property/:id/pricing
├── レイアウト:
│   ├── ヘッダー: 施設名 + ステータス
│   ├── タブナビゲーション
│   │   ├── [基本設定] → フォーム表示
│   │   ├── [カレンダー] → カレンダー表示
│   │   └── [インポート・同期] → ツール表示
│   └── コンテンツエリア
```

---

## 5. 実装優先度

### フェーズ1（MVP）
- [ ] 基本設定の表示・編集機能
- [ ] シンプルなカレンダー表示（日別価格確認のみ）
- [ ] 単日の価格編集機能
- [ ] Beds24同期機能（基本設定のみ）

### フェーズ2（拡張）
- [ ] 複数日ドラッグ&ドロップ一括設定
- [ ] ブラックアウト管理
- [ ] CSVインポート/エクスポート
- [ ] 日別の最小宿泊日数設定

### フェーズ3（高度な機能）
- [ ] 季節別料金テンプレート
- [ ] 自動価格調整ルール
- [ ] 日別在庫状況の可視化
- [ ] 予約カレンダーとの統合表示

---

## 6. 技術選定

### カレンダーライブラリ
| ライブラリ | メリット | デメリット | 推奨度 |
|-----------|---------|----------|--------|
| React Big Calendar | 豊機能、実績多 | 重い | ⭐⭐⭐⭐ |
| React Calendar | シンプル | 日別編集は要カスタム | ⭐⭐⭐ |
| react-dates | 日付範囲選択最適 | カレンダー機能限定的 | ⭐⭐ |
| カスタム実装 | 軽量、完全制御可 | 開発コスト高 | ⭐ |

**推奨: React Big Calendar** - Material-UI との統合も容易

---

## 7. UX パターン集

### 7.1 よくあるタスク

#### タスク1: 4月の全日程を¥15,000に設定
```
1. カレンダーを4月に移動
2. 4月1日をクリック → 初日を選択
3. ドラッグして4月30日まで
4. 「¥15,000」 をクリック
5. [適用] ボタンで完了
```

#### タスク2: ゴールデンウイークをブラックアウト
```
1. 基本設定で「最小宿泊日数: 3泊」を設定
2. 4月28日～5月6日をドラッグ選択
3. [ブラックアウト] ボタンをクリック
4. [確認] で完了
```

#### タスク3: 個別カスタム価格を設定（7月1日の¥18,000）
```
1. 7月1日をクリック
2. 「カスタム」タブを選択
3. ¥18,000 を入力
4. [保存] で完了
```

---

## 8. 参考 UI コンポーネント構成

```
PricingManagement.jsx
├── BasicSettingsPanel
│   ├── PriceInput
│   ├── GuestCountInput
│   ├── ExtraChargesSection
│   └── EditDialog
├── CalendarView
│   ├── MonthNavigation
│   ├── CalendarGrid
│   ├── DayCell (クリック可能)
│   └── CellEditDialog
├── BulkActionPanel
│   ├── PriceBrushTool
│   ├── BlackoutToggle
│   └── MinNightsSelector
└── ImportExportPanel
    ├── CSVUploader
    ├── Beds24Sync
    └── ExportButton
```

---

## 9. まとめ

### 推奨デザイン: **ハイブリッド型**

**理由:**
1. ✅ Beds24利用者にも直感的
2. ✅ モバイル・デスクトップ両対応が容易
3. ✅ 実装難易度とUXのバランスが最適
4. ✅ 段階的な機能追加が可能
5. ✅ 将来的にカレンダー機能を強化可能

**実装ロードマップ:**
- フェーズ1（1-2週間）: 基本設定 + シンプルカレンダー
- フェーズ2（2-3週間）: ドラッグ&ドロップ、CSV対応
- フェーズ3（3-4週間）: 季節料金、自動調整機能
